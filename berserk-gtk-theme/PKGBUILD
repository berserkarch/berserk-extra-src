# shellcheck disable=SC2034,SC2154,SC2317
# Maintainer: Gaurav Raj (@thehackersbrain) <me@thehackersbrain.xyz>

pkgname=berserk-gtk-theme
pkgver=0.1.0
pkgrel=7
pkgdesc="Default gtk theme for BerserkArch Based on and derieved from Kali Linux"
arch=('any')
url="https://gitlab.com/berserkarch/berserk-packages/berserk-core-src/"
license=('GPLv3')
depends=('git')
makedepends=('gtk3' 'sassc' 'meson' 'ninja' 'git')
source=("$pkgname::git+https://gitlab.com/kalilinux/packages/adw-gtk3-kali.git" "git+https://gitlab.com/kalilinux/packages/kali-themes" "index.theme" 'Makefile')
sha256sums=('SKIP'
            'SKIP'
            'ac93ea5ef781847cb403b084c9212422ce823e835ac1e64a971295c7d23203c8'
            '5ca6fa00a1b531e5d7e0d36c2916a66ded74ccbc55492df0f7bfe95702d132c1')

prepare() {
  cd "$srcdir/$pkgname"
  meson setup build
  ninja -C build
  DESTDIR="$startdir/_pkg" ninja -C build install
}

build() {
  mkdir -p "$startdir/themes/BerserkDark"
  cp -r "$srcdir/kali-themes/share/themes/Kali-Dark/." "$startdir/themes/BerserkDark/"
  rm -rf "$startdir/BerserkDark/Kali-Dark" "$startdir/themes/BerserkDark/index.theme"
  cp -r "$startdir/_pkg/usr/share/themes/adw-gtk3-dark/gtk-3.0" "$startdir/themes/BerserkDark/"
  cp -r "$startdir/_pkg/usr/share/themes/adw-gtk3-dark/gtk-4.0" "$startdir/themes/BerserkDark/"
  install -Dm755 "$srcdir/index.theme" "$startdir/themes/BerserkDark/"
}

package() {
  install -dm755 "$pkgdir/usr/share/"
  make
  rm -rf "${startdir}/themes/BerserkDark"
  cp -r "${startdir}/themes/" "$pkgdir/usr/share/"
  rm -rf "${startdir}/themes/"
}
